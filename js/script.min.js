function _defineProperty(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class Caption{constructor(e="",a="",t=!1,i=!1){let s,o;this.text=e,this.elementId=a,this.isAvenida=t,this.isEdificio=i,({x:s,y:o}=this.getElementPosition(a,this.isAvenida)),this.div=document.createElement("div"),this.captionId=this.elementId,this.captionId.includes("cercado-svg-caption")?this.captionId=this.captionId.replace("cercado-svg-",""):this.captionId.includes("cocha-svg-caption")?this.captionId=this.captionId.replace("cocha-svg-",""):this.captionId="caption-"+this.captionId,this.div.setAttribute("id",this.captionId),this.div.classList.add("caption"),this.div.classList.add("hidden"),this.isAvenida&&this.div.classList.add("avenida"),i&&this.div.classList.add("edificio"),this.setPosition(s,o,this.isAvenida),this.div.appendChild(document.createTextNode(e)),this.add(),Caption.list.set(this.captionId,this)}getElementPosition(e,a){const t=document.getElementById(e);let i,s,o,c;return({x:i,y:s,right:o,bottom:c}=t.getBoundingClientRect()),a?{x:o,y:c}:{x:i,y:s}}setPosition(e,a,t){this.posX=e,this.posY=a,this.div.style.left=this.posX+"px",this.div.style.top=this.posY+"px"}setText(e){this.div.textContent=e}add(){document.body.appendChild(this.div)}show(){this.div.classList.remove("hidden")}hide(){this.div.classList.add("hidden")}static purge(){Caption.list.forEach((e=>e.div.remove())),Caption.list=new Map}static updateAllPositions(){Caption.list.forEach((e=>{const{x:a,y:t}=e.getElementPosition(e.elementId);e.setPosition(a,t)}))}static getCaption(e){return Caption.list.has(e)||console.error(`Caption id ${e} does not exist`),Caption.list.get(e)}static hideAllCaptions(){Caption.list.forEach((e=>{e.div.classList.add("hidden")}))}static showAllCaptions(){Caption.list.forEach((e=>{e.div.classList.remove("hidden")}))}static init(){Caption.purge();[{id:"cocha-svg-caption-cercado",text:"Cercado",translate:"translate(-50%,-50%)"}].forEach((({id:e,text:a,translate:t="",isAvenida:i=!1,isEdificio:s=!1})=>{const o=new Caption(a,e,i,s);t&&(o.div.style.transform=t)})),[{id:"cercado-svg-caption-rocha",text:"Río Rocha"},{id:"cercado-svg-caption-recoleta",text:"Recoleta"},{id:"cercado-svg-caption-libertadores",text:"Av. Libertadores",translate:"translate(-50%, -50%) rotate(75deg)",isAvenida:!0},{id:"cercado-svg-caption-juan-rosa",text:"Av. Juan de la Rosa",translate:"translate(-50%, -50%) rotate(28deg)",isAvenida:!0},{id:"cercado-svg-caption-cuellar",text:"Laguna Cuellar"},{id:"cercado-svg-caption-quillacollo",text:"Puente Quillacollo"},{id:"cercado-svg-caption-america",text:"Av. América",translate:"translate(-50%, -50%) rotate(3deg)",isAvenida:!0},{id:"cercado-svg-caption-melchor-perez",text:"Av. Melchor Pérez",translate:"translate(-50%, -50%) rotate(-85deg)",isAvenida:!0},{id:"cercado-svg-caption-sarco",text:"Laguna Sarco"},{id:"cercado-svg-caption-belzu",text:"Av. Belzu",translate:"translate(-50%, -50%) rotate(65deg)",isAvenida:!0},{id:"cercado-svg-caption-campus-umss",text:"UMSS",translate:"translate(-50%, -50%) rotate(-10deg)",isEdificio:!0},{id:"cercado-svg-caption-heroinas",text:"Av. Heroínas",translate:"translate(-50%, -50%) rotate(-10deg)",isAvenida:!0},{id:"cercado-svg-caption-cuadras",text:"Laguna Cuadras"},{id:"cercado-svg-caption-cona-cona",text:"Laguna Coña Coña"},{id:"cercado-svg-caption-alalay",text:"Laguna Alalay"},{id:"cercado-svg-caption-quenamari",text:"Laguna Quenamari"},{id:"cercado-svg-caption-aeropuerto",text:"Aeropuerto",translate:"translate(-50%, -50%) rotate(42deg)",isEdificio:!0},{id:"cercado-svg-caption-tamborada",text:"La Tamborada"}].forEach((({id:e,text:a,translate:t="",isAvenida:i=!1,isEdificio:s=!1})=>{const o=new Caption(a,e,i,s);t&&(o.div.style.transform=t)}))}}_defineProperty(Caption,"list",new Map);const windowY=document.documentElement.clientHeight,lightblue="#00dbfc",orange="#ff7a00",grey="#3b4749",lightgrey="#f9fafa",invisible="rgba(0,0,0,0)",white="#fff",wrapper=()=>{const e=new Map;return{hide:a=>{e.has(a)||e.set(a,document.getElementById(a)),e.get(a).classList.add("hidden")},show:a=>{e.has(a)||e.set(a,document.getElementById(a)),e.get(a).classList.remove("hidden"),e.get(a).style.opacity=1}}},{hide:hide,show:show}=wrapper(),setChildrenOpacityZero=e=>{const a=document.getElementById(e).children;for(let e=0;e<a.length;e++)a[e].style.opacity=0},showCaptions=e=>{e.forEach((e=>{getCaption(e).show()})),Caption.updateAllPositions()},prepCochaMap=()=>{Caption.hideAllCaptions(),hide("cercado-map-container"),show("cocha-map-container"),anime.set("#cocha-map-container",{opacity:1})},prepCercadoMap=()=>{hide("cocha-map-container"),document.querySelector(".arrow").classList.add("hidden"),Caption.hideAllCaptions(),setChildrenOpacityZero("cercado-svg-lagunas"),setChildrenOpacityZero("cercado-svg-puentes"),setChildrenOpacityZero("cercado-svg-rios"),setChildrenOpacityZero("cercado-svg-avenidas"),setChildrenOpacityZero("cercado-svg-edificios"),show("cercado-map-container"),anime.set("#cercado-svg",{opacity:1}),show("cercado-svg-inner-elements"),hide("lag-cuellar"),hide("lag-sarco"),hide("lag-cuadras"),hide("lag-alalay"),hide("lag-cona-cona"),hide("lag-quenamari"),document.querySelector("#rio-rocha").classList.remove("draw-rocha"),document.querySelector("#rio-tamborada").classList.remove("draw-tamborada")},getCaption=Caption.getCaption,introAnim=anime({targets:"#cocha-svg",scale:1.05,delay:250,direction:"alternate",loop:!0,easing:"linear",autoplay:!0}),sec0Prep=()=>{prepCochaMap(),anime.set("#cocha-map-container",{translateX:0,translateY:0,scale:1}),anime.set("#cocha-svg-cocha",{fill:"#00dbfc"}),hide("cocha-svg-cercado")},sec0Anim=anime({autoplay:!1}),sec1Prep=sec0Prep,sec1Anim={play:()=>{},restart:()=>{},seek:()=>{}},sec2Prep=()=>{sec0Prep(),document.querySelector(".arrow").classList.add("hidden"),show("cocha-svg-cercado"),anime.set("#cocha-svg-cercado",{fill:"#00dbfc"}),Caption.updateAllPositions()},sec2Anim=anime({targets:"#cocha-svg-cocha",fill:white,complete:()=>{getCaption("caption-cercado").show()},easing:"linear",autoplay:!1}),sec3Prep=()=>{sec2Prep(),anime.set("#cocha-svg-cocha",{fill:white}),Caption.updateAllPositions(),getCaption("caption-cercado").show()},sec3Anim=anime({targets:"#cocha-svg-cercado",fill:["#00dbfc",grey],easing:"linear",autoplay:!1,duration:2e3}),sec4Prep=()=>{sec3Prep(),anime.set("#cocha-svg-cercado",{fill:grey}),document.getElementById("cercado-svg").style.transform="translate( max( -14vw, -14vh ), min( 5.8vw, 5.8vh ) ) scale( 0.08 )",show("cercado-map-container"),hide("cercado-svg-inner-elements"),Caption.hideAllCaptions()},sec4Anim=anime({targets:["#cercado-svg","#cocha-map-container"],begin:()=>hide("cocha-svg-cercado"),translateX:(e,a)=>{if(1==a)return[0,0];const t=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),i=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);return[Math.round(Math.max(-.14*t,-.14*i)),0]},translateY:(e,a)=>{if(1==a)return[0,0];const t=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),i=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);return[Math.round(.058*Math.min(t,i)),0]},scale:(e,a)=>1==a?[1,12]:[.08,1],opacity:(e,a)=>1==a?[1,0]:[1,1],easing:"easeInQuart",autoplay:!1,duration:2e3}),sec5Prep=()=>{prepCercadoMap(),anime.set("#cercado-svg",{translateX:0,translateY:0,scale:1}),show("lag-cuellar"),anime.set("#lag-cuellar",{opacity:0}),getCaption("caption-cuellar").setText("Laguna Cuellar")},captionsSec5=["caption-recoleta","caption-quillacollo","caption-cuellar","caption-rocha","caption-tamborada","caption-libertadores","caption-juan-rosa"],showCaptionsSec5=()=>showCaptions(captionsSec5),sec5Anim=anime.timeline({targets:"#cercado-svg",translateX:[0,"-20%"],translateY:[0,"30%"],scale:[1,6],duration:1e3,easing:"linear",autoplay:!1}).add({targets:["#lag-cuellar","#cercado-svg-rios path","#p-recoleta, #p-quillacollo","#libertadores","#juan-rosa"],opacity:[0,1],complete:showCaptionsSec5}),sec6Prep=()=>{prepCercadoMap(),anime.set("#cercado-svg",{translateX:"-20%",translateY:"30%",scale:6}),anime.set(["#lag-cuellar","#cercado-svg-rios path","#p-recoleta, #p-quillacollo","#libertadores","#juan-rosa"],{opacity:1}),show("lag-cuellar"),getCaption("caption-cuellar").setText("Laguna Cuellar"),showCaptionsSec5()},sec6Anim=anime.timeline({targets:"#lag-cuellar",opacity:[1,0],easing:"easeInOutCubic",duration:1500,autoplay:!1}).add({targets:"#estadio",opacity:[0,1],complete:()=>{getCaption("caption-cuellar").setText("Estadio Félix Capriles"),hide("lag-cuellar")}}),sec7Prep=()=>{sec6Prep(),hide("lag-cuellar"),show("lag-sarco"),Caption.hideAllCaptions(),anime.set(["#lag-cuellar","#libertadores","#juan-rosa"],{opacity:0})},captionsSec7=["caption-sarco","caption-america","caption-melchor-perez","caption-recoleta","caption-quillacollo","caption-rocha","caption-tamborada"],showCaptionsSec7=()=>showCaptions(captionsSec7),sec7Anim=anime.timeline({targets:"#cercado-svg",keyframes:[{translateX:["-20%",0],translateY:["30%",0],scale:[6,2.5],duration:1500},{duration:1e3},{translateX:[0,0],translateY:[0,"40%"],scale:[2.5,6],duration:1500}],easing:"easeInCubic",duration:4e3,autoplay:!1}).add({targets:["#melchor-perez","#america","#lag-sarco"],complete:showCaptionsSec7,opacity:[0,1]}),sec8Prep=()=>{sec7Prep(),anime.set("#cercado-svg",{translateX:0,translateY:"40%",scale:6}),anime.set(["#melchor-perez","#america","#lag-sarco"],{opacity:1}),getCaption("caption-sarco").setText("Laguna Sarco"),showCaptionsSec7()},sec8Anim=anime.timeline({targets:"#lag-sarco",opacity:[1,0],duration:1500,easing:"easeInCubic",autoplay:!1}).add({targets:"#complejo-sarco",opacity:[0,1],complete:()=>{getCaption("caption-sarco").setText("Complejo Deportivo Sarco"),hide("lag-sarco")}}),sec9Prep=()=>{prepCercadoMap(),anime.set("#cercado-svg",{translateX:0,translateY:"40%",scale:6}),anime.set(["#cercado-svg-rios path","#p-recoleta, #p-quillacollo"],{opacity:1}),show("lag-cuadras"),getCaption("caption-cuadras").setText("Laguna Cuadras"),getCaption("caption-sarco").setText("Laguna Sarco")},captionsSec9=["caption-cuadras","caption-heroinas","caption-belzu","caption-quillacollo","caption-campus-umss"],showCaptionsSec9=()=>showCaptions(captionsSec9),sec9Anim=anime.timeline({targets:"#cercado-svg",keyframes:[{translateX:[0,"-10%"],translateY:["40%",0],scale:[6,2.5],duration:1500},{duration:1e3},{translateX:["-10%","-40%"],translateY:[0,0],scale:[2.5,6],duration:1500}],delay:0,duration:4e3,easing:"easeInCubic",autoplay:!1}).add({targets:["#lag-cuadras","#heroinas","#belzu","#campus-umss"],complete:showCaptionsSec9,opacity:[0,1],duratioon:5e3,easing:"easeInQuint"}),sec10Prep=()=>{prepCercadoMap(),show("lag-cuadras"),anime.set("#cercado-svg",{translateX:"-40%",translateY:0,scale:6}),anime.set(["#heroinas","#belzu","#campus-umss","#cercado-svg-rios path","#p-recoleta, #p-quillacollo"],{opacity:1}),getCaption("caption-cuadras").setText("Laguna Cuadras"),showCaptionsSec9()},sec10Anim=anime.timeline({targets:"#lag-cuadras",opacity:[1,0],easing:"easeInCubic",duration:2e3,autoplay:!1}).add({targets:"#estacion-teleferico",opacity:[0,1],complete:()=>{getCaption("caption-cuadras").setText("Estación Parque Teleférico"),hide("lag-cuadras")}}),sec11Prep=()=>{prepCercadoMap(),document.querySelector("#lag-quenamari").classList.remove("shrink"),show("lag-alalay"),show("lag-cona-cona"),show("lag-quenamari"),anime.set("#cercado-svg",{translateX:"-40%",translateY:0,scale:6}),anime.set(["#cercado-svg-rios path","#p-recoleta, #p-quillacollo"],{opacity:1})},captionsSec11=["caption-alalay","caption-cona-cona","caption-quenamari","caption-quillacollo","caption-tamborada","caption-recoleta","caption-rocha","caption-aeropuerto"],showCaptionsSec11=()=>showCaptions(captionsSec11),sec11Anim=anime.timeline({targets:"#cercado-svg",scale:[4,2],translateX:["-30%","-10%"],translateY:[0,0],easing:"easeInCubic",duration:2e3,autoplay:!1}).add({targets:"#lag-alalay",begin:()=>{document.querySelector("#rio-rocha").classList.add("draw-rocha"),document.querySelector("#rio-tamborada").classList.add("draw-tamborada")},opacity:[0,1]}).add({targets:"#lag-quenamari",opacity:[0,1]}).add({targets:["#lag-cona-cona","#aeropuerto"],complete:showCaptionsSec11,opacity:[0,1]}),sec12Prep=()=>{prepCercadoMap(),document.querySelector("#lag-quenamari").classList.remove("shrink"),show("lag-alalay"),show("lag-cona-cona"),show("lag-quenamari"),anime.set("#cercado-svg",{translateX:"-10%",translateY:0,scale:2}),anime.set(["#cercado-svg-rios path","#p-recoleta, #p-quillacollo","#aeropuerto"],{opacity:1})},sec12Anim=anime({targets:"#cercado-svg",complete:()=>{showCaptionsSec11(),document.querySelector("#lag-quenamari").classList.add("shrink")},translateX:["-10%","10%"],translateY:[0,"-30%"],scale:[2,2.5],easing:"easeInCubic",duration:2e3,autoplay:!1}),sec13Prep=()=>{prepCercadoMap(),show("lag-alalay"),show("lag-cona-cona"),show("lag-quenamari"),anime.set("#cercado-svg",{translateX:"10%",translateY:"-30%",scale:2.5}),anime.set(["#cercado-svg-rios path","#p-recoleta, #p-quillacollo","#aeropuerto"],{opacity:1})},sec13Anim=anime({targets:"#cercado-svg",complete:()=>{anime.set("#cocha-svg-cocha",{fill:white}),anime.set("#cocha-map-container",{translateX:0,translateY:0,scale:1}),hide("cocha-svg-cercado"),prepCochaMap()},opacity:[1,0],translateX:["10%",0],translateY:["-30%",0],scale:[2.5,.5],duration:2e3,easing:"easeInCubic",autoplay:!1}),cuellarSlideShow=[{src:"media/cuellar-1.jpg",title:"Los cisnes de la Laguna Cuellar",credits:'—Revista "Ahora: Historias y Leyendas de Cochabamba"'},{src:"media/cuellar-2.jpg",title:"Laguna Cuellar",credits:"—Cochabamba, 1925"}],sarcoSlideShow=[{src:"media/sarco-1.jpg",title:"El espejo de la Laguna Sarco",credits:"—Rodolfo Torrico Zamudio (ca. 1940-1950)"}],cuadrasSlideShow=[{src:"",credits:"—No se tienen fotos de la Laguna Cuadras"}];class Director{constructor(){this.imgList=new Map,this.imgList.set("default",document.querySelector("#slideshow img")),this.modal=document.querySelector(".modal"),this.slideshow=document.querySelector("#slideshow"),this.figcaption=document.querySelector("#slideshow figcaption"),this.cite=document.querySelector("#slideshow cite"),this.index=0,this.prev=document.querySelector(".side-arrow.prev"),this.img=document.querySelector("#slideshow img"),this.next=document.querySelector(".side-arrow.next"),this.slideShowList=[],this.isVisible=!1}async start(e){this.index=0,this.slideShowList=e,this.showArrows(),this.modal.classList.add("show-modal"),this.isVisible=!0,await this.showSingleImg()}reset(){this.figcaption.textContent="",this.cite.textContent="",this.img!==this.imgList.get("default")&&(this.slideshow.replaceChild(this.imgList.get("default"),this.img),this.img=this.imgList.get("default"))}showArrows(){0==this.index?this.prev.classList.add("hidden"):this.prev.classList.remove("hidden"),this.slideShowList.length>1&&this.index<this.slideShowList.length-1?this.next.classList.remove("hidden"):this.next.classList.add("hidden")}async showSingleImg(){this.reset();const{src:e,title:a,credits:t}=this.slideShowList[this.index];a&&this.figcaption.appendChild(document.createTextNode(a)),e?(this.imgList.has(e)?this.imgList.get(e):this.imgList.set(e,await this.loadImg(e)),this.slideshow.replaceChild(this.imgList.get(e),this.img),this.img=this.imgList.get(e)):(this.slideshow.replaceChild(this.imgList.get("default"),this.img),this.img=this.imgList.get("default")),t&&this.cite.appendChild(document.createTextNode(t))}async loadImg(e){return new Promise(((a,t)=>{let i=new Image;i.onload=()=>a(i),i.onerror=t,i.src=e}))}stop(){this.modal.classList.remove("show-modal"),this.isVisible=!1}async nextImg(){this.index++,this.showArrows(),await this.showSingleImg()}async prevImg(){this.index--,this.showArrows(),await this.showSingleImg()}}const director=new Director;document.querySelector(".modal").addEventListener("click",(e=>{e.target===document.querySelector("#slideshow")&&director.stop()})),document.querySelector(".close-modal-button").addEventListener("click",(()=>director.stop())),document.querySelector(".side-arrow.prev").addEventListener("click",(()=>director.prevImg())),document.querySelector(".side-arrow.next").addEventListener("click",(()=>director.nextImg())),document.querySelector("#photos-cuellar").addEventListener("click",(()=>{director.start(cuellarSlideShow)})),document.querySelector("#photos-sarco").addEventListener("click",(()=>{director.start(sarcoSlideShow)})),document.querySelector("#photos-cuadras").addEventListener("click",(()=>{director.start(cuadrasSlideShow)}));const init=()=>{sec0Prep(),Caption.init()},getImage=e=>{switch(e.target.id){case"lag-cuellar":director.start(cuellarSlideShow);break;case"lag-sarco":director.start(sarcoSlideShow);break;case"lag-cuadras":director.start(cuadrasSlideShow)}},getSectionSizes=()=>({inicioSize:Math.round(getComputedStyle(document.documentElement).getPropertyValue("--inicio-size")*windowY),sectionSize:Math.max(Math.round(getComputedStyle(document.documentElement).getPropertyValue("--section-size")*windowY),getComputedStyle(document.documentElement).getPropertyValue("--min-section-size"))}),{inicioSize:inicioSize,sectionSize:sectionSize}={inicioSize:Math.round(getComputedStyle(document.documentElement).getPropertyValue("--inicio-size")*windowY),sectionSize:Math.max(Math.round(getComputedStyle(document.documentElement).getPropertyValue("--section-size")*windowY),getComputedStyle(document.documentElement).getPropertyValue("--min-section-size"))};let currentSection=-1;const scrollCallback=e=>{director.isVisible&&director.stop();const a=Math.round(window.scrollY)+Math.round(windowY/2),t=(e,a,t)=>{currentSection!=e&&(anime.running.forEach((e=>e.pause())),t(),a.restart(),a.play(),currentSection=e)};window.requestAnimationFrame((()=>{switch(Math.ceil((a-inicioSize)/sectionSize)){case 0:t(0,sec0Anim,(()=>{document.querySelector(".arrow").classList.remove("hidden"),sec0Prep()}));break;case 1:t(1,sec1Anim,(()=>{document.querySelector(".arrow").classList.remove("hidden"),sec1Prep()}));break;case 2:t(2,sec2Anim,sec2Prep);break;case 3:t(3,sec3Anim,sec3Prep);break;case 4:t(4,sec4Anim,sec4Prep);break;case 5:t(5,sec5Anim,sec5Prep);break;case 6:t(6,sec6Anim,sec6Prep);break;case 7:t(7,sec7Anim,sec7Prep);break;case 8:t(8,sec8Anim,sec8Prep);break;case 9:t(9,sec9Anim,sec9Prep);break;case 10:t(10,sec10Anim,sec10Prep);break;case 11:t(11,sec11Anim,sec11Prep);break;case 12:t(12,sec12Anim,sec12Prep);break;case 13:t(13,sec13Anim,sec13Prep)}}))},isMobile=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);window.onbeforeunload=()=>{},window.onresize=Caption.updateAllPositions,document.addEventListener("scroll",scrollCallback),document.querySelectorAll("#cercado-svg-lagunas circle").forEach((e=>e.addEventListener("click",getImage))),sec0Prep(),Caption.init();
